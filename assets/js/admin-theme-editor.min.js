!function(d){"use strict";window.PUM_Admin=window.PUM_Admin||{},window.pum_theme_settings_editor=window.pum_theme_settings_editor||{form_args:{},current_values:{}},PUM_Admin.themeEditor={preview_fixed_scroll:function(){var e=d("#pum_theme_preview"),t=e.parent(),o=e.offset().top-50;d(window).on("scroll",function(){d("> .postbox:visible",t).index(e)===d("> .postbox:visible",t).length-1&&d(window).scrollTop()>=o?e.css({left:e.offset().left,width:e.width(),height:e.height(),position:"fixed",top:50}):e.removeAttr("style")})},update_font_options:function(e){var t,o,i=d('select[id="'+e+'_font_family"]'),n=d('select[id="'+e+'_font_weight"]'),r=d('select[id="'+e+'_font_style"]'),s=n.find("option"),l=r.find("option"),a=[400,300,700,100,200,500,600,800,900],_=["","italic"],p=i.val(),c=n.val(),e=r.val();if(void 0!==pum_google_fonts[p]){if(t=pum_google_fonts[p],s.prop("disabled",!0),l.prop("disabled",!0),t.variants.length)for(o=0;t.variants.length>o;o+=1)"regular"===t.variants[o]?(d('option[value="400"]',n).prop("disabled",!1),d('option[value=""]',r).prop("disabled",!1)):(0<=t.variants[o].indexOf("italic")&&d('option[value="italic"]',r).prop("disabled",!1),d('option[value="'+parseInt(t.variants[o],10)+'"]',n).prop("disabled",!1))}else s.prop("disabled",!1),l.prop("disabled",!1);if(""===c||s.filter('[value="'+c+'"]').is(":disabled"))for(o=0;o<a.length;o+=1)if(!s.filter('[value="'+a[o]+'"]').is(":disabled")){n.val(a[o]);break}if(l.filter('[value="'+e+'"]').is(":disabled"))for(o=0;o<_.length;o+=1)if(!l.filter('[value="'+_[o]+'"]').is(":disabled")){r.val(_[o]);break}i.trigger("change.select2"),n.trigger("change.select2"),i.trigger("change.select2"),n=n.parents(".pum-field"),1<s.filter(":not(:disabled)").length?n.show():n.hide(),i=r.parents(".pum-field"),1<l.filter(":not(:disabled)").length?i.show():i.hide()},update_font_selectboxes:function(){return d('select[id$="_font_family"]').each(function(){PUM_Admin.themeEditor.update_font_options(d(this).attr("id").replace("_font_family",""))})},update_loaded_font:function(e){var t=d('select[id="'+e+'_font_family"]'),o=d('select[id="'+e+'_font_weight"]'),i=d('select[id="'+e+'_font_style"]'),n=t.val(),t=o.val(),o=i.val(),i=d("link#pum-"+e+"google-font"),e=d('<link id="pum-'+e+'google-font" rel="stylesheet" type="text/css">');void 0!==pum_google_fonts[n]?(n="//fonts.googleapis.com/css?family="+n,"normal"!==t&&(n+=":"+t),"italic"===o&&(-1===n.indexOf(":")&&(n+=":"),n+="italic"),e.attr("href",n),i.length?i.attr("href")!==n&&i.replaceWith(e):d("body").append(e)):i.remove()},update_loaded_fonts:function(){return d('select[id$="_font_family"]').each(function(){PUM_Admin.themeEditor.update_loaded_font(d(this).attr("id").replace("_font_family",""))})},refresh_preview:function(){var e=d("#pum-theme-settings-container").pumSerializeObject(),t=e.theme_settings;if(void 0!==window.PUM_ATB)for(var o in delete e.theme_settings,e)e.hasOwnProperty(o)&&(t[o.replace("popup_theme_","")]=e[o]);PUM_Admin.themeEditor.restyle_preview(t)},restyle_preview:function(e){var t,o,i,n,r=d(".pum-popup-overlay"),s=d(".pum-popup-container"),l=d(".pum-popup-title",s),a=d(".pum-popup-content",s),_=d(".pum-popup-close",s),p="yes"===e.container_boxshadow_inset?"inset ":"",c="yes"===e.close_boxshadow_inset?"inset ":"";switch(PUM_Admin.themeEditor.update_loaded_fonts(),r.removeAttr("style").css({backgroundColor:window.PUM_Admin.utils.convert_hex(e.overlay_background_color,e.overlay_background_opacity)}),s.removeAttr("style").css({padding:e.container_padding+"px",backgroundColor:window.PUM_Admin.utils.convert_hex(e.container_background_color,e.container_background_opacity),borderStyle:e.container_border_style,borderColor:e.container_border_color,borderWidth:e.container_border_width+"px",borderRadius:e.container_border_radius+"px",boxShadow:p+e.container_boxshadow_horizontal+"px "+e.container_boxshadow_vertical+"px "+e.container_boxshadow_blur+"px "+e.container_boxshadow_spread+"px "+window.PUM_Admin.utils.convert_hex(e.container_boxshadow_color,e.container_boxshadow_opacity)}),l.removeAttr("style").css({color:e.title_font_color,lineHeight:e.title_line_height+"px",fontSize:e.title_font_size+"px",fontFamily:e.title_font_family,fontStyle:e.title_font_style,fontWeight:e.title_font_weight,textAlign:e.title_text_align,textShadow:e.title_textshadow_horizontal+"px "+e.title_textshadow_vertical+"px "+e.title_textshadow_blur+"px "+window.PUM_Admin.utils.convert_hex(e.title_textshadow_color,e.title_textshadow_opacity)}),a.removeAttr("style").css({color:e.content_font_color,fontFamily:e.content_font_family,fontStyle:e.content_font_style,fontWeight:e.content_font_weight}),_.removeAttr("style").css({position:e.close_position_outside?"fixed":"absolute",padding:e.close_padding+"px",height:0<e.close_height?e.close_height+"px":"auto",width:0<e.close_width?e.close_width+"px":"auto",backgroundColor:window.PUM_Admin.utils.convert_hex(e.close_background_color,e.close_background_opacity),color:e.close_font_color,lineHeight:e.close_line_height+"px",fontSize:e.close_font_size+"px",fontFamily:e.close_font_family,fontWeight:e.close_font_weight,fontStyle:e.close_font_style,borderStyle:e.close_border_style,borderColor:e.close_border_color,borderWidth:e.close_border_width+"px",borderRadius:e.close_border_radius+"px",boxShadow:c+e.close_boxshadow_horizontal+"px "+e.close_boxshadow_vertical+"px "+e.close_boxshadow_blur+"px "+e.close_boxshadow_spread+"px "+window.PUM_Admin.utils.convert_hex(e.close_boxshadow_color,e.close_boxshadow_opacity),textShadow:e.close_textshadow_horizontal+"px "+e.close_textshadow_vertical+"px "+e.close_textshadow_blur+"px "+window.PUM_Admin.utils.convert_hex(e.close_textshadow_color,e.close_textshadow_opacity)}),e.close_text=e.close_text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),_.html(e.close_text),t=e.close_position_top+(e.close_position_outside?d("#wpadminbar").outerHeight():0),o=e.close_position_left+(e.close_position_outside?d("#adminmenuwrap").outerWidth():0),i=e.close_position_right,n=e.close_position_bottom,e.close_location){case"topleft":_.css({top:t+"px",left:o+"px"});break;case"topcenter":_.css({top:t+"px",left:"50%",transform:"translateX(-50%)"});break;case"topright":_.css({top:t+"px",right:i+"px"});break;case"middleleft":_.css({top:"50%",left:o+"px",transform:"translateY(-50%)"});break;case"middleright":_.css({top:"50%",right:i+"px",transform:"translateY(-50%)"});break;case"bottomleft":_.css({bottom:n+"px",left:o+"px"});break;case"bottomcenter":_.css({bottom:n+"px",left:"50%",transform:"translateX(-50%)"});break;case"bottomright":_.css({bottom:n+"px",right:i+"px"})}d(document).trigger("popmake-admin-retheme",[e]),d(document).trigger("pumRestylePreview",[e])}},d(document).on("change",'select[id$="_font_family"]',function(){var e=d(this).attr("id").replace("_font_family","");PUM_Admin.themeEditor.update_font_options(e)}).on("click",".pum-popup-overlay, .pum-popup-container, .pum-popup-title, .pum-popup-content, .pum-popup-close",function(e){var t=d(this).attr("class");switch(e.preventDefault(),e.stopPropagation(),t){case"pum-popup-overlay":d('a[href="#pum-theme-settings_overlay"]')[0].click();break;case"pum-popup-container":d('a[href="#pum-theme-settings_container"]')[0].click();break;case"pum-popup-title":d('a[href="#pum-theme-settings_title"]')[0].click();break;case"pum-popup-content":d('a[href="#pum-theme-settings_content"]')[0].click();break;case"pum-popup-close":d('a[href="#pum-theme-settings_close"]')[0].click()}d("html, body").animate({scrollTop:d("#pum_theme_settings").offset().top-40+"px"})}).on("change colorchange input focusout",".pum-field select, .pum-field input",function(){PUM_Admin.themeEditor.refresh_preview()}),d(function(){d(this).trigger("pum_init");var e=d("#pum-theme-settings-container"),t=pum_theme_settings_editor.form_args||{},o=pum_theme_settings_editor.current_values||{};e.length&&(e.find(".pum-no-js").hide(),PUM_Admin.forms.render(t,o,e)),PUM_Admin.themeEditor.preview_fixed_scroll(),PUM_Admin.themeEditor.refresh_preview()})}(jQuery);