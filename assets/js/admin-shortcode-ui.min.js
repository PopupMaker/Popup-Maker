!function(s){function t(){var t=s("#pum-shortcode-editor-pum_sub_form #provider"),e=""!==t.val()&&"none"!==t.val()?t.val():pum_admin_vars.default_provider,o=s('.pum-modal-content .tabs .tab a[href^="#pum-shortcode-editor-pum_sub_form_provider_"]'),i=s('[id^="pum-shortcode-editor-pum_sub_form_provider_"]'),n=o.filter('[href="#pum-shortcode-editor-pum_sub_form_provider_'+e+'"]'),r=i.filter('[id="pum-shortcode-editor-pum_sub_form_provider_'+e+'"]');o.each(function(){s(this).parent().hide()}),i.find(":input").attr("disable",!0),n.length&&(n.parent().show(),r.find(":input").attr("disable",!1))}function e(){var t=s("#pum-shortcode-editor-pum_sub_form_provider_mailchimp #list_id").val(),e=s("#pum-mci-list-"+t+",.pum-mci-list-"+t),o=s(".pum-mci-list-options");o.hide(),o.find('input[type="checkbox"]').attr("disabled",!0),e.length&&(e.show(),e.find('input[type="checkbox"]').attr("disabled",!1))}void 0===window.pum_newsletter_initialized&&(window.pum_newsletter_initialized=!0,s(document).on("pum_init","#pum-shortcode-editor-pum_sub_form",t).on("change","#pum-shortcode-editor-pum_sub_form #provider",t),s(document).on("pumInit pum_init","#pum-shortcode-editor-pum_sub_form",e).on("change","#pum-shortcode-editor-pum_sub_form_provider_mailchimp #list_id",e))}(jQuery),function(d){"use strict";if(void 0!==window.pum_shortcode_ui_vars){var i=pum_shortcode_ui_vars.I10n||{error_loading_shortcode_preview:"",shortcode_ui_button_tooltip:"",insert:"",update:""},t=pum_shortcode_ui_vars.shortcodes||{},o={version:1,shortcode_args:{},shortcode_data:{},initialize:function(t){},cleanAttrs:function(o){return _.each(o,function(t,e){null!==t&&""!==t||delete o[e],"object"==typeof t&&(o[e]=Object.keys(t))}),o},template:function(t){var e,o="pum-shortcode-view-"+this.type,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"attrs"};return 1===this.version&&(i.variable="attr"),d("#tmpl-"+o).length?(e=_.template(d("#tmpl-"+o).html(),i),t.class&&(t.classes=t.class,delete t.class),e(t=this.cleanAttrs(t))):this.text},getShortcodeValues:function(){if(void 0===this.shortcode||void 0===this.shortcode.attrs)return{};var t={};if(void 0!==this.shortcode.attrs.named&&(t=_.extend(t,this.shortcode.attrs.named||{})),void 0!==this.shortcode.attrs.numeric)for(var e=0;e<this.shortcode.attrs.numeric.length;e++)t[this.shortcode.attrs.numeric[e]]=!0;return t},getShortcodeContent:function(){return void 0!==this.shortcode&&this.shortcode.content||""},getContent:function(){return this.content||this.fetch(),this.content},formatShortcode:function(t){var e=this.shortcode_args.has_content,o=this.getShortcodeContent();return t=t||this.getShortcodeValues(),e&&void 0!==t._inner_content&&(o=t._inner_content,delete t._inner_content),t=this.cleanAttrs(t),PUM_Admin.templates.shortcode({tag:this.type,meta:t,has_content:e,content:o})},fetch:function(){var e=this,t=e.getShortcodeValues(),o={action:"pum_do_shortcode",post_id:d("#post_ID").val(),tag:e.type,shortcode:e.formatShortcode(),nonce:pum_shortcode_ui_vars.nonce};e.fetching||(e.fetching=!0,e.shortcode_args.has_content&&(t._inner_content=e.getShortcodeContent()),e.shortcode_args.ajax_rendering?d.post(ajaxurl,o).done(function(t){e.content=t.data}).fail(function(){e.content='<span class="pum_shortcode_ui_vars_error">'+i.error_loading_shortcode_preview+"</span>"}).always(function(){delete e.fetching,e.render()}):(e.content=e.template(t),delete e.fetching,e.render()))},edit:function(t,e){var o=_.extend({},this.getShortcodeValues());this.shortcode_args.has_content&&(o._inner_content=this.getShortcodeContent()),this.renderForm(o,e)},setLoader:function(){this.setContent('<div class="loading-placeholder"><div class="dashicons dashicons-admin-generic"></div><div class="wpview-loading"><ins></ins></div></div>')},renderForm:function(t,n){var r=this,s=d.extend(!0,{},{tag:this.type,id:"pum-shortcode-editor-"+this.type,label:"",tabs:{},sections:{},fields:{}},r.shortcode_args);t=t||{},PUM_Admin.modals.reload("#"+s.id,PUM_Admin.templates.modal({id:s.id,title:s.label,description:s.description,classes:"tabbed-content pum-shortcode-editor",save_button:void 0===t?i.insert:i.update,content:PUM_Admin.forms.render({id:"pum-shortcode-editor-"+this.type,tabs:s.tabs||{},sections:s.sections||{},fields:s.fields||{}},t||{}),meta:{"data-shortcode_tag":this.type}})),d("#"+s.id+" form").on("submit",function(t){t.preventDefault();var e,o=d(this),i=(o.pumSerializeObject(),PUM_Admin.forms.parseValues(o.pumSerializeObject().attrs,PUM_Admin.forms.flattenFields(s)));e=r.formatShortcode(i),"function"==typeof n&&n(e),PUM_Admin.modals.closeAll()})}};d(document).on("pumFormDependencyMet pumFormDependencyUnmet",".pum-shortcode-editor .pum-field",function(t){var e=d(this).find(":input");"pumFormDependencyUnmet"===t.type.toString()?e.prop("disabled",!0):e.prop("disabled",!1)}).ready(function(){window.wp=window.wp||{},window.wp.mce=window.wp.mce||{},window.wp.mce.pum_shortcodes=window.wp.mce.pum_shortcodes||{},_.each(t,function(t,e){wp.mce.pum_shortcodes[e]=_.extend({},o,{version:t.version||1,shortcode_args:t,View:{type:e,template:function(t){return wp.mce.pum_shortcodes[this.type].template(t)},postID:d("#post_ID").val(),initialize:function(t){this.shortcode=t.shortcode,wp.mce.pum_shortcodes[this.type].shortcode_data=this.shortcode},getHtml:function(){var t=this.shortcode.attrs.named;return this.shortcode_args.has_content&&(t._inner_content=this.shortcode.content),this.template(t)}}}),void 0!==wp.mce.views&&"function"==typeof wp.mce.views.register&&wp.mce.views.register(e,wp.mce.pum_shortcodes[e])})})}}(jQuery);